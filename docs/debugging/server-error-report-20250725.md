# 서버 시작 오류 분석 및 해결 보고서

- **날짜:** 2025년 07월 25일
- **담당자:** AI Assistant

## 1. 문제 요약

`npm run dev` 명령어로 개발 서버 실행 시, 500 내부 서버 오류가 발생하며 애플리케이션이 정상적으로 실행되지 않았습니다. 로그 분석 결과, 문제는 두 가지 주요 원인이 복합적으로 작용한 것으로 확인되었습니다.

## 2. 핵심 원인

### 2.1. `app/layout.js` 파일 손상

- **현상:** 서버 로그에서 `stream did not contain valid UTF-8` 및 `NulError`가 지속적으로 발생했습니다.
- **분석:** `app/layout.js` 파일 내부에 눈에 보이지 않는 `NUL` 문자가 포함되어 파일이 손상되었습니다. 이로 인해 Next.js 서버가 파일을 정상적으로 읽거나 파싱하지 못하고 Rust 레벨에서 패닉을 일으켰습니다. 파일이 바이너리 형식으로 잠겨 직접적인 수정 및 삭제가 불가능했습니다.

### 2.2. 설정 파일의 경로 별칭 불일치

- **현상:** `pages` 라우터에서 `app` 라우터로 마이그레이션하는 과정에서 관련 설정 파일들이 올바르게 업데이트되지 않았습니다.
- **분석:**
    - `tsconfig.json`과 `jsconfig.json`의 `paths` 별칭이 여전히 이전 `pages` 디렉터리 구조를 참조하고 있었습니다.
    - `next.config.js`에는 웹팩이 새로운 경로 별칭을 인식하도록 하는 `webpack.resolve.alias` 설정이 누락되어 있었습니다.
- **결과:** 이로 인해 모듈 해석(resolution) 과정에서 오류가 발생하여, 파일 손상 문제 해결 후에도 서버가 정상적으로 실행되지 못했습니다.

## 3. 해결 과정

1.  **프로세스 강제 종료:** `taskkill /F /IM node.exe` 명령어를 사용하여 파일을 잠그고 있던 모든 `node` 프로세스를 강제 종료했습니다.
2.  **손상 파일 우회 및 제거:**
    - `move` 명령어로 손상된 `app/layout.js` 파일을 `app/temp` 디렉터리로 이동시켰습니다.
    - `rm -r app/temp` 명령어로 `temp` 디렉터리 전체를 삭제하여 손상된 파일을 완전히 제거했습니다.
3.  **파일 재생성:** 정상적인 기본 코드로 `app/layout.js` 파일을 새로 생성했습니다.
4.  **경로 설정 수정:**
    - `tsconfig.json`과 `jsconfig.json`의 `paths` 설정을 현재의 `app` 디렉터리 구조에 맞게 수정하고 통일했습니다.
5.  **Webpack 설정 추가:**
    - `next.config.js`에 `webpack.resolve.alias` 설정을 추가하여, 수정된 경로 별칭을 웹팩이 정상적으로 인식하도록 조치했습니다.
6.  **서버 재시작 및 검증:** 모든 수정 사항을 적용한 후 서버를 재시작하여 정상 작동을 확인했습니다.

## 4. 재발 방지 대책

- **파일 인코딩 확인:** 파일 저장 시 항상 `UTF-8` 인코딩을 사용하도록 에디터 설정을 확인하고, 예기치 않은 종료 등으로 파일이 손상되지 않도록 주의합니다.
- **프로젝트 구조 변경 시 설정 파일 동시 업데이트:** `pages` -> `app` 라우터 마이그레이션과 같이 프로젝트의 핵심 구조를 변경할 경우, `tsconfig.json`, `jsconfig.json`, `next.config.js` 등 관련된 모든 설정 파일을 반드시 함께 점검하고 수정하는 절차를 규칙화합니다.
- **주기적인 타입 체크:** `npm run type-check` 명령어를 주기적으로 실행하여, 경로 및 타입 관련 문제를 조기에 발견하고 해결합니다. 